
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Jianyu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="PengYuan">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="Jianyu">
<meta property="og:url" content="https://pengyuanqiuqiu.github.io/page/2/index.html">
<meta property="og:site_name" content="Jianyu">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jianyu">

    
    <link rel="alternative" href="http://www.163.com/rss/" title="Jianyu" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Jianyu" title="Jianyu"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Jianyu">Jianyu</a></h1>
				<h2 class="blog-motto">Learn more and more</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:pengyuanqiuqiu.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/06/19/数据倾斜的解决方法/" title="数据倾斜（转）" itemprop="url">数据倾斜（转）</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-06-19T08:20:39.334Z" itemprop="datePublished"> 发表于 2018-06-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><h3 id="数据倾斜介绍"><a href="#数据倾斜介绍" class="headerlink" title="数据倾斜介绍"></a>数据倾斜介绍</h3><p>简单的讲，数据倾斜就是我们在计算数据的时候，数据的分散度不够，导致大量的数据集中到了一台或者几台机器上计算，这些数据的计算速度远远低于平均计算速度，导致整个计算过程过慢。 </p>
<p>在做Shuffle阶段的优化过程中，遇到了数据倾斜的问题，造成了对一些情况下优化效果不明显。主要是因为在Job完成后的所得到的Counters是整个Job的总和，优化是基于这些Counters得出的平均值，而由于数据倾斜的原因造成map处理数据量的差异过大，使得这些平均值能代表的价值降低。Hive的执行是分阶段的，map处理数据量的差异取决于上一个stage的reduce输出，所以如何将数据均匀的分配到各个reduce中，就是解决数据倾斜的根本所在。规避错误来更好的运行比解决错误更高效。在查看了一些资料后，总结如下。</p>
<p>1数据倾斜的原因 </p>
<p>1.1操作：</p>
<table>
<thead>
<tr>
<th>关键词</th>
<th>情形</th>
<th>后果</th>
</tr>
</thead>
<tbody>
<tr>
<td>Join</td>
<td>其中一个表较小，但是key集中</td>
<td>分发到某一个或几个Reduce   上的数据远       高于平均值</td>
</tr>
<tr>
<td></td>
<td>大表与大表，但是分桶的判断字段0值或空值过多</td>
<td>这些空值都由一个reduce     处理，灰常慢</td>
</tr>
<tr>
<td>group by</td>
<td>group by 维度过小，某值的数量过多</td>
<td>处理某值的reduce灰常耗时</td>
</tr>
<tr>
<td>Count Distinct</td>
<td>某特殊值过多</td>
<td>处理此特殊值的reduce耗时</td>
</tr>
</tbody>
</table>
<p>1.2原因：</p>
<p>1)、key分布不均匀</p>
<p>2)、业务数据本身的特性</p>
<p>3)、建表时考虑不周</p>
<p>4)、某些SQL语句本身就有数据倾斜</p>
<p>1.3表现：</p>
<p>任务进度长时间维持在99%（或100%），查看任务监控页面，发现只有少量（1个或几个）reduce子任务未完成。因为其处理的数据量和其他reduce差异过大。</p>
<p>单一reduce的记录数与平均记录数差异过大，通常可能达到3倍甚至更多。 最长时长远大于平均时长。</p>
<p>2数据倾斜的解决方案</p>
<p>2.1参数调节：</p>
<p>hive.map.aggr = true</p>
<p>Map 端部分聚合，相当于Combiner</p>
<p>hive.groupby.skewindata=true</p>
<p>有数据倾斜的时候进行负载均衡，当选项设定为 true，生成的查询计划会有两个 MR Job。第一个 MR Job 中，Map 的输出结果集合会随机分布到 Reduce 中，每个 Reduce 做部分聚合操作，并输出结果，这样处理的结果是相同的 Group By Key 有可能被分发到不同的 Reduce 中，从而达到负载均衡的目的；第二个 MR Job 再根据预处理的数据结果按照 Group By Key 分布到 Reduce 中（这个过程可以保证相同的 Group By Key 被分布到同一个 Reduce 中），最后完成最终的聚合操作。</p>
<p>2.2 SQL语句调节：</p>
<p>如何Join：</p>
<p>关于驱动表的选取，选用join key分布最均匀的表作为驱动表</p>
<p>做好列裁剪和filter操作，以达到两表做join的时候，数据量相对变小的效果。</p>
<p>大小表Join：</p>
<p>使用map join让小的维度表（1000条以下的记录条数） 先进内存。在map端完成reduce.</p>
<p>大表Join大表：</p>
<p>把空值的key变成一个字符串加上随机数，把倾斜的数据分到不同的reduce上，由于null值关联不上，处理后并不影响最终结果。</p>
<p>count distinct大量相同特殊值</p>
<p>count distinct时，将值为空的情况单独处理，如果是计算count distinct，可以不用处理，直接过滤，在最后结果中加1。如果还有其他计算，需要进行group by，可以先将值为空的记录单独处理，再和其他计算结果进行union。</p>
<p>group by维度过小：</p>
<p>采用sum() group by的方式来替换count(distinct)完成计算。</p>
<p>特殊情况特殊处理：</p>
<p>在业务逻辑优化效果的不大情况下，有些时候是可以将倾斜的数据单独拿出来处理。最后union回去。</p>
<p>3典型的业务场景</p>
<p>3.1空值产生的数据倾斜</p>
<p>场景：如日志中，常会有信息丢失的问题，比如日志中的 user_id，如果取其中的 user_id 和 用户表中的user_id 关联，会碰到数据倾斜的问题。</p>
<p>解决方法1： user_id为空的不参与关联</p>
<p>select * from log a</p>
<p>  join users b</p>
<p>  on a.user_id is not null</p>
<p>  and a.user_id = b.user_id</p>
<p>union all</p>
<p>select * from log a</p>
<p>  where a.user_id is null;</p>
<p>解决方法2 ：赋与空值分新的key值</p>
<p>select *</p>
<p>  from log a</p>
<p>  left outer join users b</p>
<p>  on case when a.user_id is null then concat(‘hive’,rand() ) else a.user_id end = b.user_id;</p>
<p>结论：方法2比方法1效率更好，不但io少了，而且作业数也少了。解决方法1中 log读取两次，jobs是2。解决方法2 job数是1 。这个优化适合无效 id (比如 -99 , ’’, null 等) 产生的倾斜问题。把空值的 key 变成一个字符串加上随机数，就能把倾斜的数据分到不同的reduce上 ,解决数据倾斜问题。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/31/奇异值分解(SVD)/" title="奇异值分解(SVD)" itemprop="url">奇异值分解(SVD)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-31T12:33:20.236Z" itemprop="datePublished"> 发表于 2018-05-31</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>奇异值分解（singular Value Decomposition），简称SVD，线性代数中矩阵分解的方法。假如有一个矩阵A，对它进行奇异值分解，可以得到三个矩阵：</p>
<p><img src="http://120.25.221.136/images/svd/svd.png" alt=""></p>
<p>分解矩阵的大小为下面：</p>
<p><img src="http://120.25.221.136/images/svd/fenjie.png" alt=""></p>
<p>在第二个矩阵中的矩阵特点是除了对角线不为0其余的元素都为0，并且对角线元素都是按照从大到小的排序。将上面中间矩阵只保存少数元素。</p>
<p><img src="http://120.25.221.136/images/svd/fenjie2.png" alt="">实际应用中，我们仅需保留着三个比较小的矩阵，就能表示A，不仅节省存储量，在计算的时候更是减少了计算量。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/31/python定义私有变量/" title="python定义私有变量" itemprop="url">python定义私有变量</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-31T12:09:32.565Z" itemprop="datePublished"> 发表于 2018-05-31</time>
    
  </p>
</header>
    <div class="article-content">
        
        <ul>
<li><h2 id="python对象销毁-垃圾回收"><a href="#python对象销毁-垃圾回收" class="headerlink" title="python对象销毁(垃圾回收)"></a>python对象销毁(垃圾回收)</h2><p>Python 使用了引用计数这一简单技术来跟踪和回收垃圾。</p>
<p>在 Python 内部记录着所有使用中的对象各有多少引用。</p>
<p>一个内部跟踪变量，称为一个引用计数器。</p>
<p>当对象被创建时， 就创建了一个引用计数， 当这个对象不再需要时， 也就是说， 这个对象的引用计数变为0 时， 它被垃圾回收。但是回收不是”立即”的， 由解释器在适当的时机，将垃圾对象占用的内存空间回收。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = 40      # 创建对象  &lt;40&gt;</span><br><span class="line">b = a       # 增加引用， &lt;40&gt; 的计数</span><br><span class="line">c = [b]     # 增加引用.  &lt;40&gt; 的计数</span><br><span class="line"></span><br><span class="line">del a       # 减少引用 &lt;40&gt; 的计数</span><br><span class="line">b = 100     # 减少引用 &lt;40&gt; 的计数</span><br><span class="line">c[0] = -1   # 减少引用 &lt;40&gt; 的计数</span><br></pre></td></tr></table></figure>
<p>垃圾回收机制不仅针对引用计数为0的对象，同样也可以处理循环引用的情况。循环引用指的是，两个对象相互引用，但是没有其他变量引用他们。这种情况下，仅使用引用计数是不够的。Python 的垃圾收集器实际上是一个引用计数器和一个循环垃圾收集器。作为引用计数的补充， 垃圾收集器也会留心被分配的总量很大（及未通过引用计数销毁的那些）的对象。 在这种情况下， 解释器会暂停下来， 试图清理所有未引用的循环。</p>
</li>
</ul>
<h3 id="类的私有属性"><a href="#类的私有属性" class="headerlink" title="类的私有属性"></a>类的私有属性</h3><p><strong>__private_attrs</strong>：两个下划线开头，声明该属性为私有，不能在类的外部被使用或直接访问。在类内部的方法中使用时 <strong>self.__private_attrs</strong>。</p>
<h3 id="类的方法"><a href="#类的方法" class="headerlink" title="类的方法"></a>类的方法</h3><p>在类的内部，使用 def 关键字可以为类定义一个方法，与一般函数定义不同，类方法必须包含参数 self,且为第一个参数</p>
<h3 id="类的私有方法"><a href="#类的私有方法" class="headerlink" title="类的私有方法"></a>类的私有方法</h3><p><strong>__private_method</strong>：两个下划线开头，声明该方法为私有方法，不能在类地外部调用。在类的内部调用 <strong>self.__private_methods</strong></p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JustCounter</span>:</span></span><br><span class="line">    __secretCount = <span class="number">0</span>  <span class="comment"># 私有变量</span></span><br><span class="line">    publicCount = <span class="number">0</span>    <span class="comment"># 公开变量</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.__secretCount += <span class="number">1</span></span><br><span class="line">        self.publicCount += <span class="number">1</span></span><br><span class="line">        <span class="keyword">print</span> self.__secretCount</span><br><span class="line"> </span><br><span class="line">counter = JustCounter()</span><br><span class="line">counter.count()</span><br><span class="line">counter.count()</span><br><span class="line"><span class="keyword">print</span> counter.publicCount</span><br><span class="line"><span class="keyword">print</span> counter.__secretCount  <span class="comment"># 报错，实例不能访问私有变量</span></span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/30/平方损失函数为什么用平方形式/" title="平方损失函数为什么用平方形式" itemprop="url">平方损失函数为什么用平方形式</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-30T02:48:31.041Z" itemprop="datePublished"> 发表于 2018-05-30</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="平方损失函数形式"><a href="#平方损失函数形式" class="headerlink" title="平方损失函数形式"></a>平方损失函数形式</h4><p><strong>误差平方和(sse)：(The sum of squares due to error)</strong></p>
<p><img src="http://120.25.221.136/images/loss/sseloss.png" alt=""></p>
<p><strong>均方差（mse):(mean squared error)</strong></p>
<p><img src="http://120.25.221.136/images/loss/meanloss.png" alt=""></p>
<p>均方差与误差平方和形式上是等价的，两个公式前面的1/2是在求导时能够将2省略掉。</p>
<h3 id="平方形式的原因"><a href="#平方形式的原因" class="headerlink" title="平方形式的原因"></a>平方形式的原因</h3><ul>
<li><p>损失函数的值为正数</p>
<p>在计算损失时，会出现正数和负数，为了防止损失被抵消，所以全部都转变为正数累加。</p>
</li>
<li><p>能够惩罚大误差</p>
<p>惩罚大误差更快寻找误差较小的最优权重值。</p>
</li>
<li><p>求导方便</p>
<p>虽然4次方，6次方也可以避免损失之下损失值相互抵消但惩罚过大，造成欠拟合，且求导之后扔是多次函数。绝对值求导为分段函数，需要分段求导。</p>
</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/28/动态规划解决01背包问题/" title="动态规划解决01背包问题（转）" itemprop="url">动态规划解决01背包问题（转）</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-28T02:30:21.853Z" itemprop="datePublished"> 发表于 2018-05-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>0-1 背包问题：给定 n 种物品和一个容量为 C 的背包，物品 i 的重量是 wi，其价值为 vi 。</p>
<p>问：应该如何选择装入背包的物品，使得装入背包中的物品的总价值最大？</p>
<p>对于每个物体，要么放入背包要么不放进背包，不存在将物体的一部分放入背包。</p>
<p><strong>三、动态规划的原理及过程：</strong></p>
<p>　　eg：number＝4，capacity＝8</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>i</strong></th>
<th style="text-align:center"><strong>1</strong></th>
<th style="text-align:center"><strong>2</strong></th>
<th style="text-align:center"><strong>3</strong></th>
<th style="text-align:center"><strong>4</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>w(体积)</strong></td>
<td style="text-align:center">2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center"><strong>v(价值)</strong></td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
</tr>
</tbody>
</table>
<p><strong>1**</strong>、<strong>**原理</strong></p>
<p>　　动态规划与分治法类似，都是把大问题拆分成小问题，通过寻找大问题与小问题的递推关系，解决一个个小问题，最终达到解决原问题的效果。但不同的是，分治法在子问题和子子问题等上被重复计算了很多次，而动态规划则具有记忆性，通过填写表把所有已经解决的子问题答案纪录下来，在新问题里需要用到的子问题可以直接提取，避免了重复计算，从而节约了时间，所以在问题满足最优性原理之后，用动态规划解决问题的核心就在于填表，表填写完毕，最优解也就找到。</p>
<p><strong>2**</strong>、<strong>**过程</strong></p>
<p>　　a) 把背包问题抽象化（X1，X2，…，Xn，其中 Xi 取0或1，表示第 i 个物品选或不选），Vi表示第 i 个物品的价值，Wi表示第 i 个物品的体积（重量）；</p>
<p>　　b) 建立模型，即求max(V1X1+V2X2+…+VnXn)；</p>
<p>　　c) 约束条件，W1X1+W2X2+…+WnXn&lt;capacity；</p>
<p>　　d) 定义V(i,j)：当前背包容量 j，前 i 个物品最佳组合对应的价值；</p>
<p>　　e) 最优性原理是动态规划的基础，最优性原理是指“多阶段决策过程的最优决策序列具有这样的性质：不论初始状态和初始决策如何，对于前面决策所造成的某一状态而言，其后各阶段的决策序列必须构成最优策略”。判断该问题是否满足最优性原理，采用反证法证明：</p>
<p>　　　　假设(X1，X2，…，Xn)是01背包问题的最优解，则有(X2，X3，…，Xn)是其子问题的最优解，</p>
<p>　　　　假设(Y2，Y3，…，Yn)是上述问题的子问题最优解，则理应有(V2Y2+V3Y3+…+VnYn)+V1X1 &gt; (V2X2+V3X3+…+VnXn)+V1X1；</p>
<p>　　　　而(V2X2+V3X3+…+VnXn)+V1X1=(V1X1+V2X2+…+VnXn)，则有(V2Y2+V3Y3+…+VnYn)+V1X1 &gt; (V1X1+V2X2+…+VnXn)；</p>
<p>　　　　该式子说明(X1，Y2，Y3，…，Yn)才是该01背包问题的最优解，这与最开始的假设(X1，X2，…，Xn)是01背包问题的最优解相矛盾，故01背包问题满足最优性原理；</p>
<p>　　f) 寻找递推关系式，面对当前商品有两种可能性：</p>
<p>　　　　第一，包的容量比该商品体积小，装不下，此时的价值与前i-1个的价值是一样的，即V(i,j)=V(i-1,j)；</p>
<p>　　　　第二，还有足够的容量可以装该商品，但装了也不一定达到当前最优价值，所以在装与不装之间选择最优的一个，即V(i,j)=max｛ V(i-1,j)，V(i-1,j-w(i))+v(i) ｝</p>
<p>　　　　　　　其中V(i-1,j)表示不装，V(i-1,j-w(i))+v(i) 表示装了第i个商品，背包容量减少w(i)但价值增加了v(i)；</p>
<p>　　　　由此可以得出递推关系式：</p>
<p>　　　　1) <strong>j&lt;w(i)</strong>      <strong>V(i,j)=V(i-1,j)</strong></p>
<p>　　　　2) <strong>j&gt;=w(i)</strong>     <strong>V(i,j)=max**</strong>｛<strong> </strong>V(i-1,j)<strong><strong>，</strong></strong>V(i-1,j-w(i))+v(i)<strong> </strong>｝**</p>
<p>　　g) 填表，首先初始化边界条件，V(0,j)=V(i,0)=0；</p>
<p> <img src="https://images2015.cnblogs.com/blog/1065397/201703/1065397-20170328165007186-1423294617.png" alt="img"></p>
<p>　　h) 然后一行一行的填表，</p>
<p>　　　　1) 如，i=1，j=1，w(1)=2，v(1)=3，有j&lt;w(1)，故V(1,1)=V(1-1,1)=0；</p>
<p>　　　　2) 又如i=1，j=2，w(1)=2，v(1)=3，有j=w(1),故V(1,2)=max｛ V(1-1,2)，V(1-1,2-w(1))+v(1) ｝=max｛0，0+3｝=3；</p>
<p>　　　　3) 如此下去，填到最后一个，i=4，j=8，w(4)=5，v(4)=6，有j&gt;w(4)，故V(4,8)=max｛ V(4-1,8)，V(4-1,8-w(4))+v(4) ｝=max｛9，4+6｝=10；所以填完表如下图：</p>
<p> <img src="https://images2015.cnblogs.com/blog/1065397/201703/1065397-20170328165055498-1241953671.png" alt="img"></p>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="function"><span class="keyword">void</span> <span class="title">FindMax</span><span class="params">()</span><span class="comment">//动态规划</span></span></span><br><span class="line"><span class="function"> 2 </span>&#123;</span><br><span class="line"> <span class="number">3</span>     <span class="keyword">int</span> i,j;</span><br><span class="line"> <span class="number">4</span>     <span class="comment">//填表</span></span><br><span class="line"> <span class="number">5</span>     <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=number;i++)</span><br><span class="line"> <span class="number">6</span>     &#123;</span><br><span class="line"> <span class="number">7</span>         <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=capacity;j++)</span><br><span class="line"> <span class="number">8</span>         &#123;</span><br><span class="line"> <span class="number">9</span>             <span class="keyword">if</span>(j&lt;w[i])<span class="comment">//包装不进</span></span><br><span class="line"><span class="number">10</span>             &#123;</span><br><span class="line"><span class="number">11</span>                 V[i][j]=V[i<span class="number">-1</span>][j];</span><br><span class="line"><span class="number">12</span>             &#125;</span><br><span class="line"><span class="number">13</span>             <span class="keyword">else</span><span class="comment">//能装</span></span><br><span class="line"><span class="number">14</span>             &#123;</span><br><span class="line"><span class="number">15</span>                 <span class="keyword">if</span>(V[i<span class="number">-1</span>][j]&gt;V[i<span class="number">-1</span>][j-w[i]]+v[i])<span class="comment">//不装价值大</span></span><br><span class="line"><span class="number">16</span>                 &#123;</span><br><span class="line"><span class="number">17</span>                     V[i][j]=V[i<span class="number">-1</span>][j];</span><br><span class="line"><span class="number">18</span>                 &#125;</span><br><span class="line"><span class="number">19</span>                 <span class="keyword">else</span><span class="comment">//前i-1个物品的最优解与第i个物品的价值之和更大</span></span><br><span class="line"><span class="number">20</span>                 &#123;</span><br><span class="line"><span class="number">21</span>                     V[i][j]=V[i<span class="number">-1</span>][j-w[i]]+v[i];</span><br><span class="line"><span class="number">22</span>                 &#125;</span><br><span class="line"><span class="number">23</span>             &#125;</span><br><span class="line"><span class="number">24</span>         &#125;</span><br><span class="line"><span class="number">25</span>     &#125;</span><br><span class="line"><span class="number">26</span> &#125;</span><br></pre></td></tr></table></figure>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<p>　　i) 表格填完，最优解即是V(number,capacity)=V(4,8)=10，但还不知道解由哪些商品组成，故要根据最优解回溯找出解的组成，根据填表的原理可以有如下的寻解方式：</p>
<p>　　　　1) V(i,j)=V(i-1,j)时，说明没有选择第i 个商品，则回到V(i-1,j)；</p>
<p>　　　　2) V(i,j)=V(i-1,j-w(i))+v(i)实时，说明装了第i个商品，该商品是最优解组成的一部分，随后我们得回到装该商品之前，即回到V(i-1,j-w(i))；</p>
<p>　　　　3) 一直遍历到i＝0结束为止，所有解的组成都会找到。</p>
<p>　　j) 如上例子，</p>
<p>　　　　1) 最优解为V(4,8)=10，而V(4,8)!=V(3,8)却有V(4,8)=V(3,8-w(4))+v(4)=V(3,3)+6=4+6=10，所以第4件商品被选中，并且回到V(3,8-w(4))=V(3,3)；</p>
<p>　　　　2) 有V(3,3)=V(2,3)=4，所以第3件商品没被选择，回到V(2,3)；</p>
<p>　　　　3) 而V(2,3)!=V(1,3)却有V(2,3)=V(1,3-w(2))+v(2)=V(1,0)+4=0+4=4，所以第2件商品被选中，并且回到V(1,3-w(2))=V(1,0)；</p>
<p>　　　　4) 有V(1,0)=V(0,0)=0，所以第1件商品没被选择；</p>
<p> <img src="https://images2015.cnblogs.com/blog/1065397/201703/1065397-20170328165219092-1883633849.png" alt="img"></p>
<p>　　k) 到此，01背包问题已经解决，利用动态规划解决此问题的效率即是填写此张表的效率，所以动态规划的时间效率为O(number<em>capacity)=O(n</em>c)，由于用到二维数组存储子问题的解，所以动态规划的空间效率为O(n*c)；</p>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="function"><span class="keyword">void</span> <span class="title">FindWhat</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span><span class="comment">//寻找解的组成方式</span></span></span><br><span class="line"><span class="function"> 2 </span>&#123;</span><br><span class="line"> <span class="number">3</span>     <span class="keyword">if</span>(i&gt;=<span class="number">0</span>)</span><br><span class="line"> <span class="number">4</span>     &#123;</span><br><span class="line"> <span class="number">5</span>         <span class="keyword">if</span>(V[i][j]==V[i<span class="number">-1</span>][j])<span class="comment">//相等说明没装</span></span><br><span class="line"> <span class="number">6</span>         &#123;</span><br><span class="line"> <span class="number">7</span>             item[i]=<span class="number">0</span>;<span class="comment">//全局变量，标记未被选中</span></span><br><span class="line"> <span class="number">8</span>             FindWhat(i<span class="number">-1</span>,j);</span><br><span class="line"> <span class="number">9</span>         &#125;</span><br><span class="line"><span class="number">10</span>         <span class="keyword">else</span> <span class="keyword">if</span>( j-w[i]&gt;=<span class="number">0</span> &amp;&amp; V[i][j]==V[i<span class="number">-1</span>][j-w[i]]+v[i] )</span><br><span class="line"><span class="number">11</span>         &#123;</span><br><span class="line"><span class="number">12</span>             item[i]=<span class="number">1</span>;<span class="comment">//标记已被选中</span></span><br><span class="line"><span class="number">13</span>             FindWhat(i<span class="number">-1</span>,j-w[i]);<span class="comment">//回到装包之前的位置</span></span><br><span class="line"><span class="number">14</span>         &#125;</span><br><span class="line"><span class="number">15</span>     &#125;</span><br><span class="line"><span class="number">16</span> &#125;</span><br></pre></td></tr></table></figure>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<p><strong>3、空间优化</strong></p>
<p>　　l) 空间优化，每一次V(i)(j)改变的值只与V(i-1)(x) {x:1…j}有关，V(i-1)(x)是前一次i循环保存下来的值；</p>
<p>　　因此，可以将V缩减成一维数组，从而达到优化空间的目的，状态转移方程转换为 <strong>B(j)= max{B(j), B(j-w(i))+v(i)}</strong>；</p>
<p>　　并且，状态转移方程，每一次推导V(i)(j)是通过V(i-1)(j-w(i))来推导的，所以一维数组中j的扫描顺序应该从大到小(capacity到0)，否者前一次循环保存下来的值将会被修改，从而造成错误。</p>
<p> <img src="https://images2015.cnblogs.com/blog/1065397/201703/1065397-20170328165423936-1589228819.png" alt="img"></p>
<p><img src="https://images2015.cnblogs.com/blog/1065397/201703/1065397-20170328165439139-1416618143.png" alt="img"></p>
<p>　　m) 同样以上述例子中i=3时来说明，有:</p>
<p>　　　　1) i=3，j=8，w(3)=4，v(3)=5，有j&gt;w(3)，则B(8)=max｛B(8)，B(8-w(3))+v(3)｝=max｛B(8)，B(4)+5｝=max｛7，4+5｝=9；</p>
<p>　　　　2) j- -即j=7，有j&gt;w(3)，则B(7)=max｛B(7)，B(7-w(3))+v(3)｝=max｛B(7)，B(3)+5｝=max｛7，4+5｝=9；</p>
<p>　　　　3) j- -即j=6，有j&gt;w(3)，则B(6)=max｛B(6)，B(6-w(3))+v(3)｝=max｛B(6)，B(2)+5｝=max｛7，3+5｝=8；</p>
<p>　　　　4) j- -即j=5，有j&gt;w(3)，则B(5)=max｛B(5)，B(5-w(3))+v(3)｝=max｛B(5)，B(1)+5｝=max｛7，0+5｝=7；</p>
<p>　　　　5) j- -即j=4，有j＝w(3)，则B(4)=max｛B(4)，B(4-w(3))+v(3)｝=max｛B(4)，B(0)+5｝=max｛4，0+5｝=5；</p>
<p>　　　　6) j- -即j=3，有j&lt;w(3)，继续访问数组会出现越界，所以本轮操作停止，B(0)到B(3)的值保留上轮循环（i=2时）的值不变，进入下一轮循环i++；</p>
<p> <img src="https://images2015.cnblogs.com/blog/1065397/201703/1065397-20170328165558420-477181327.png" alt="img"></p>
<p>　　如果j不逆序而采用正序j=0…capacity，如上图所示，当j=8时应该有B(8)=B(8-w(3))+v(3)=B(4)+5，然而此时的B(4)已经在j=4的时候被修改过了，原来的B(4)=4，现在B(4)=5，所以计算得出B(8)=5+5=10，显然这于正确答案不符合；所以该一维数组后面的值需要前面的值进行运算再改动，如果正序便利，则前面的值将有可能被修改掉从而造成后面数据的错误；相反如果逆序遍历，先修改后面的数据再修改前面的数据，此种情况就不会出错了；</p>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="function"><span class="keyword">void</span> <span class="title">FindMaxBetter</span><span class="params">()</span><span class="comment">//优化空间后的动态规划</span></span></span><br><span class="line"><span class="function"> 2 </span>&#123;</span><br><span class="line"> <span class="number">3</span>     <span class="keyword">int</span> i,j;</span><br><span class="line"> <span class="number">4</span>     <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=number;i++)</span><br><span class="line"> <span class="number">5</span>     &#123;</span><br><span class="line"> <span class="number">6</span>         <span class="keyword">for</span>(j=capacity;j&gt;=<span class="number">0</span>;j--)</span><br><span class="line"> <span class="number">7</span>         &#123;</span><br><span class="line"> <span class="number">8</span>             <span class="keyword">if</span>(B[j]&lt;=B[j-w[i]]+v[i] &amp;&amp; j-w[i]&gt;=<span class="number">0</span> )<span class="comment">//二维变一维</span></span><br><span class="line"> <span class="number">9</span>             &#123;</span><br><span class="line"><span class="number">10</span>                 B[j]=B[j-w[i]]+v[i];</span><br><span class="line"><span class="number">11</span>             &#125;</span><br><span class="line"><span class="number">12</span>         &#125;</span><br><span class="line"><span class="number">13</span>     &#125;</span><br><span class="line"><span class="number">14</span> &#125;</span><br></pre></td></tr></table></figure>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<p>　　n) 然而不足的是，虽然优化了动态规划的空间，但是该方法不能找到最优解的解组成，因为动态规划寻早解组成一定得在确定了最优解的前提下再往回找解的构成，而优化后的动态规划只用了一维数组，之前的数据已经被覆盖掉，所以没办法寻找，所以两种方法各有其优点。</p>
<p><strong>四、蛮力法检验：</strong></p>
<p>　　1) 蛮力法是解决01背包问题最简单最容易的方法，但是效率很低</p>
<p>　　2) (X1，X2，…，Xn)其中Xi＝0或1表示第i件商品选或不选，共有n(n-1)/2种可能；</p>
<p>　　3) 最简单的方式就是把所有拿商品的方式都列出来，最后再做判断此方法是否满足装包条件，并且通过比较和记录找出最优解和解组成（如果满足则记录此时的价值和装的方式，当下一次的装法优于这次，则更新记录，如此下去到最后便会找到最优解，同时解组成也找到）；</p>
<p>　　4) n件商品，共有n(n-1)/2种可能，故蛮力法的效率是指数级别的，可见效率很低;</p>
<p>　　5) 蛮力法效率低不建议采取，但可以用于检验小规模的动态规划解背包问题的正确性和可行性，如下图输出可见，解01背包问题用动态规划是可行的：</p>
<p><img src="https://images2015.cnblogs.com/blog/1065397/201703/1065397-20170328170108279-1164054042.png" alt="img"></p>
<p><strong>五、总结：</strong></p>
<p>　　对于01背包问题，用蛮力法与用动态规划解决得到的最优解和解组成是一致的，所以动态规划解决此类问题是可行的。动态规划效率为线性，蛮力法效率为指数型，结合以上内容和理论知识可以得出，解决此问题用动态规划比用蛮力法适合得多。对于动态规划不足的是空间开销大，数据的存储得用到二维数组；好的是，当前问题的解只与上一层的子问题的解相关，所以，可以把动态规划的空间进行优化，使得空间效率从O(n*c)转化为O(c)，遗憾的是，虽然优化了空间，但优化后只能求出最优解，解组成的探索方式在该方法运行的时候已经被破坏掉；总之动态规划和优化后的动态规划各有优缺点，可以根据实际问题的需求选择不同的方式。</p>
<p><strong>六、引申：</strong></p>
<p>　　动态规划可以解决哪些类型的问题？</p>
<p>　　待解决的原问题较难，但此问题可以被不断拆分成一个个小问题，而小问题的解是非常容易获得的；如果单单只是利用递归的方法来解决原问题，那么采用的是分治法的思想，动态规划具有记忆性，将子问题的解都记录下来，以免在递归的过程中重复计算，从而减少了计算量。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/14/在mysql数据库里加一个自增id并填充数据/" title="在MySQL数据库给已有表里加一个自增字段并填充数据" itemprop="url">在MySQL数据库给已有表里加一个自增字段并填充数据</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-14T02:45:45.107Z" itemprop="datePublished"> 发表于 2018-05-14</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>在导入数据到数据库时并没有自增列，那么如何在数据库里添加自增值？</p>
<ol>
<li>在数据库表里添加一个自增列，表为test</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table test add id int</span><br></pre></td></tr></table></figure>
<ol>
<li>更改id字段属性为自增属性</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table `test` change id id int not null auto_increment primary key;</span><br></pre></td></tr></table></figure>
<p>执行上面的sql语句就可以更改表。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/09/数组中出现超过一半的数字/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-09T04:59:33.971Z" itemprop="datePublished"> 发表于 2018-05-09</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>title: 字符串的排列</p>
<h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>数组中有一个数字出现的次数超过数组长度的一半，请找出这个数字。例如输入一个长度为9的数组{1,2,3,2,2,2,5,4,2}。由于数字2在数组中出现了5次，超过数组长度的一半，因此输出2。如果不存在则输出0。</p>
<p>利用hashmap</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">MoreThanHalfNum_Solution</span><span class="params">(self, numbers)</span>:</span></span><br><span class="line">        length=int(len(numbers)/<span class="number">2</span>)</span><br><span class="line">        hashmap=&#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> numbers:</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> hashmap:</span><br><span class="line">                hashmap[i]+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                hashmap[i]=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> hashmap[i]&gt;length:</span><br><span class="line">                    <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/08/python实现pdf转word/" title="python实现pdf转word" itemprop="url">python实现pdf转word</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-08T12:42:35.541Z" itemprop="datePublished"> 发表于 2018-05-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="安装包"><a href="#安装包" class="headerlink" title="安装包"></a>安装包</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PDF转Word功能所需的依赖包如下：</span><br><span class="line"></span><br><span class="line">PDFParser（文档分析器）</span><br><span class="line"></span><br><span class="line">PDFDocument（文档对象）</span><br><span class="line"></span><br><span class="line">PDFResourceManager（资源管理器）</span><br><span class="line"></span><br><span class="line">PDFPageInterpreter（解释器）</span><br><span class="line"></span><br><span class="line">PDFPageAggregator（聚合器）</span><br><span class="line"></span><br><span class="line">LAParams（参数分析器）</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">利用pip安装pdfminer3k，可导入上述的依赖包</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pdfminer.pdfparser <span class="keyword">import</span> PDFParser, PDFDocument</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFResourceManager, PDFPageInterpreter</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.layout <span class="keyword">import</span> LAParams</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.converter <span class="keyword">import</span> PDFPageAggregator</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> configparser <span class="keyword">import</span> ConfigParser</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> open</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFResourceManager</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> process_pdf</span><br><span class="line"><span class="keyword">from</span> pdfminer.converter <span class="keyword">import</span> TextConverter</span><br><span class="line"><span class="keyword">from</span> pdfminer.layout <span class="keyword">import</span> LAParams</span><br><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_from_pdf</span><span class="params">(file_path)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(file_path, <span class="string">'rb'</span>) <span class="keyword">as</span> file:</span><br><span class="line">        resource_manager = PDFResourceManager()</span><br><span class="line">        return_str = StringIO()</span><br><span class="line">        lap_params = LAParams()</span><br><span class="line"></span><br><span class="line">        device = TextConverter(</span><br><span class="line">            resource_manager, return_str, laparams=lap_params)</span><br><span class="line">        process_pdf(resource_manager, device, file)</span><br><span class="line">        device.close()</span><br><span class="line"></span><br><span class="line">        content = return_str.getvalue()</span><br><span class="line">        return_str.close()</span><br><span class="line">        <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_text_to_word</span><span class="params">(content, file_path)</span>:</span></span><br><span class="line">    doc = Document()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> content.split(<span class="string">'\n'</span>):</span><br><span class="line">        paragraph = doc.add_paragraph()</span><br><span class="line">        paragraph.add_run(remove_control_characters(line))</span><br><span class="line">    doc.save(file_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_control_characters</span><span class="params">(content)</span>:</span></span><br><span class="line">    mpa = dict.fromkeys(range(<span class="number">32</span>))</span><br><span class="line">    <span class="keyword">return</span> content.translate(mpa)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pdf_to_word</span><span class="params">(pdf_file_path, word_file_path)</span>:</span></span><br><span class="line">    content = read_from_pdf(pdf_file_path)</span><br><span class="line">    save_text_to_word(content, word_file_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(k,)</span>:</span></span><br><span class="line">    wordker=k</span><br><span class="line">	pdf_folder=pdf路径</span><br><span class="line">    word_folder=word路径</span><br><span class="line">    tasks = []</span><br><span class="line">    <span class="keyword">with</span> ProcessPoolExecutor(max_workers=wordker) <span class="keyword">as</span> executor:</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(pdf_folder):</span><br><span class="line">            extension_name = os.path.splitext(file)[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> extension_name != <span class="string">'.pdf'</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            file_name = os.path.splitext(file)[<span class="number">0</span>]</span><br><span class="line">            pdf_file = pdf_folder+ <span class="string">'/'</span> + file</span><br><span class="line">            word_file = word_folder + <span class="string">'/'</span> + file_name + <span class="string">'.docx'</span></span><br><span class="line">            print(<span class="string">'正在处理: '</span>, file)</span><br><span class="line">            result = executor.submit(pdf_to_word, pdf_file, word_file)</span><br><span class="line">            tasks.append(result)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        exit_flag = <span class="keyword">True</span></span><br><span class="line">        <span class="keyword">for</span> task <span class="keyword">in</span> tasks:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> task.done():</span><br><span class="line">                exit_flag = <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">if</span> exit_flag:</span><br><span class="line">            print(<span class="string">'完成'</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/05/将中缀表达式转化为后缀表达式/" title="将中缀表达式转化为后缀表达式(转)" itemprop="url">将中缀表达式转化为后缀表达式(转)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-05T14:30:18.863Z" itemprop="datePublished"> 发表于 2018-05-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>我们把平时所用的标准四则运算表达式，即“9+(3-1)*3+10/2”叫做中缀表达式。因为所有的运算符号都在两数字的中间，现在我们的问题就是中缀到后缀的转化。</p>
<p><a href="http://www.nowamagic.net/librarys/veda/tag/%E4%B8%AD%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F" target="_blank" rel="noopener">中缀表达式</a>“9+(3-1)<em>3+10/2”转化为后缀表达式“9 3 1-3</em>+ 10 2/+”</p>
<ul>
<li><p>​</p>
<p>规则：从左到右遍历中缀表达式的每个数字和符号，若是数字就输出，即成为后缀表达式的一部分；若是符号，则判断其与栈顶符号的优先级，是右括号或优先级低于找顶符号（乘除优先加减）则栈顶元素依次出找并输出，并将当前符号进栈，一直到最终输出后缀表达式为止。</p>
</li>
</ul>
<p>下面我们来具体看看这个过程。</p>
<ol>
<li>初始化一空栈，用来对符号进出栈使用。</li>
<li>第一个字符是数字9，输出9，后面是符号“+”，进<a href="http://www.nowamagic.net/librarys/veda/tag/%E6%A0%88" target="_blank" rel="noopener">栈</a>。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_08.jpg" alt="img"></p>
<ol>
<li>第三个字符是“(”,依然是符号，因其只是左括号，还未配对，故进栈。</li>
<li>第四个字符是数字3，输出，总表达式为9 3,接着是“-”进栈。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_09.jpg" alt="img"></p>
<ol>
<li>接下来是数字1，输出，总表达式为9 3 1，后面是符号“)”，此时，我们需要去匹配此前的“(”，所以栈顶依次出栈，并输出，直到“(”出栈为止。此时左括号上方只有“-”，因此输出“-”，总的输出表达式为9 3 1 -</li>
<li>接着是数字3，输出，总的表达式为9 3 1 - 3 。紧接着是符号“<em>”，因为此时的栈顶符号为“+”号，优先级低于“</em>”，因此不输出，进栈。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_10.jpg" alt="img"></p>
<ol>
<li>之后是符号“+”，此时当前栈顶元素比这个“+”的优先级高，因此栈中元素出栈并输出（没有比“+”号更低的优先级，所以全部出栈），总输出表达式为 9 3 1 - 3 <em> +.然后将当前这个符号“+”进栈。也就是说，前6张图的栈底的“+”是指中缀表达式中开头的9后面那个“+”，而下图中的栈底（也是栈顶）的“+”是指“9+(3-1)</em>3+”中的最后一个“+”。</li>
<li>紧接着数字10，输出，总表达式变为9 3 1-3 * + 10。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_11.jpg" alt="img"></p>
<ol>
<li>最后一个数字2,输出，总的表达式为 9 3 1-3*+ 10 2</li>
<li>因已经到最后，所以将栈中符号全部出栈并输出。最终输出的后缀表达式结果为 9 3 1-3*+ 10 2/+</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_12.jpg" alt="img"></p>
<ul>
<li><p>​</p>
<p>从刚才的推导中你会发现，要想让计算机具有处理我们通常的标准（中缀）表达式的能力，最重要的就是两步：</p>
</li>
</ul>
<ol>
<li>将中缀表达式转化为后缀表达式（栈用来进出运算的符号）。</li>
<li>将后缀表达式进行运算得出结果（栈用来进出运算的数字）。</li>
</ol>
<p>整个过程，都充分利用了找的后进先出特性来处理，理解好它其实也就理解好了栈这个数据结构。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/05/05/图解后缀表达式的计算过程/" title="图解后缀表达式的计算过程(转)" itemprop="url">图解后缀表达式的计算过程(转)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="PengYuan" target="_blank" itemprop="author">PengYuan</a>
		
  <p class="article-time">
    <time datetime="2018-05-05T14:27:27.922Z" itemprop="datePublished"> 发表于 2018-05-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>为了解释后缀表达式的好处，我们先来看看，计算机如何应用<a href="http://www.nowamagic.net/librarys/veda/tag/%E5%90%8E%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F" target="_blank" rel="noopener">后缀表达式</a>计算出最终的结果20的。</p>
<p>后缀表达式：9 3 1-3*+ 10 2/+</p>
<p>规则：从左到右遍历表达式的每个数字和符号，遇到是数字就进栈，遇到是符号，就将处于栈顶两个数字出栈，进行运算，运算结果进栈，一直到最终获得结果。</p>
<p>下面是详细的步骤：</p>
<ol>
<li>初始化一个空<a href="http://www.nowamagic.net/librarys/veda/tag/%E6%A0%88" target="_blank" rel="noopener">栈</a>。此桟用来对要运算的数字进出使用。</li>
<li>后缀表达式中前三个都是数字，所以9、3、1进栈。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_02.jpg" alt="img"></p>
<ol>
<li>接下来是减号“-”，所以将栈中的1出栈作为减数，3出栈作为被减数，并运算3-1得到2，再将2进栈。</li>
<li>接着是数字3进栈。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_03.jpg" alt="img"></p>
<ol>
<li>后面是乘法“*”，也就意味着栈中3和2出栈，2与3相乘，得到6，并将6进栈。</li>
<li>下面是加法“+”，所以找中6和9出找，9与6相加，得到15，将15进栈。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_04.jpg" alt="img"></p>
<ol>
<li>接着是10与2两数字进栈。</li>
<li>接下来是符号因此，栈顶的2与10出栈，10与2相除，得到5，将5进栈。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_05.jpg" alt="img"></p>
<ol>
<li>最后一个是符号“+”，所以15与5出找并相加，得到20，将20进栈。</li>
<li>结果是20出栈，栈变为空。</li>
</ol>
<p><img src="http://www.nowamagic.net/librarys/images/201210/2012_10_22_06.jpg" alt="img"></p>
<p>一、后缀表达式——-操作符位于操作数之后的表达式。（也叫逆波兰表达式）</p>
<p>举个例子：</p>
<p>中缀表达式 —– 9+(6+5)*2-7</p>
<p>后缀表达式 —– 9 6 5 + 2 * + 7 -</p>
<p>PS：文章末尾会附有中缀表达式转为后缀表达式的规则</p>
<p>二、后缀表达式的计算</p>
<p>简单来讲，后缀表达式的计算就是从左到右扫描表达式，遇到数字就将其压入栈，遇到操作符表示可以计算，这时取出栈顶的两个元素进行操作，然后再次将结果压入栈，最后栈里会留下一个元素，该元素就是运行结果（详解看图）</p>
<p><img src="https://img-blog.csdn.net/20160911225209660?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="img"></p>
<p>三、思路</p>
<p>大体思路就是：需要一个结构体来存放标识符（标记这个数据是数字还是操作符），除此之外，就是需要一个结构体数组了，数组里边存放的是具体内容。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="https://github.com/pengyuanqiuqiu" data-theme="medium"></div>
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>



  

  

  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.nowcoder.com/" target="_blank" title="牛客网">牛客网</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.acmcoder.com/index" target="_blank" title="赛码网">赛码网</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="http://www.163.com/rss/" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="400" class="share_self"  frameborder="0" scrolling="no" src="https://widget.weibo.com/weiboshow/index.php?language=&width=0&height=400&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=1&isFans=0&uid=2871001534&verifier=2889e96f&colors=d6f3f7,ffffff,666666,0082cb,ecfbfd&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m jianyu. <br/>
			Let&#39;s go!</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2871001534" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/pengyuanqiuqiu" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		<a href="http://www.zhihu.com/people/peng-yuan-19-57?utm_source=qq&amp;utm_medium=social" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		
		<a href="mailto:987219258@qq.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by © 2018 
		
		<a href="https://pengyuanqiuqiu.github.io/" target="_blank" title="PengYuan">PengYuan</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>












<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
